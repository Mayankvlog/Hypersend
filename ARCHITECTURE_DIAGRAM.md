# ğŸ“Š HYPERSEND - ARCHITECTURE & DEPLOYMENT DIAGRAM

## ğŸ—ï¸ COMPLETE SYSTEM ARCHITECTURE

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          HYPERSEND DEPLOYMENT                           â•‘
â•‘                        VPS 139.59.82.105                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EXTERNAL USERS (INTERNET)                        â”‚
â”‚  â€¢ Mobile App          â€¢ Web Browser          â€¢ Desktop                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ HTTP(S)
                                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚       VPS 139.59.82.105 - Docker Host             â”‚
        â”‚                                                   â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚    Docker Compose Network                   â”‚  â”‚
        â”‚  â”‚    172.20.0.0/16 (hypersend_network)        â”‚  â”‚
        â”‚  â”‚                                             â”‚  â”‚
        â”‚  â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â”€â”€â”€â”€â”€â”€â”€â”€â•â•â•â•â”€â”€â”€â”€â•â•â•â•â•â•â•â•â•—   â”‚  â”‚
        â”‚  â”‚  â•‘   Frontend (Flet Web)    :8550     â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘                                    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Material Design 3 UI            â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ 15 Languages                    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Mobile-first Layout             â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ HTTPx HTTP/2 Client             â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Container: hypersend_frontend   â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Image: hypersend-frontend       â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Status: âœ… Healthy             â•‘   â”‚  â”‚
        â”‚  â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚  â”‚
        â”‚  â”‚           â”‚                                 â”‚  â”‚
        â”‚  â”‚           â”‚ Internal Docker Network         â”‚  â”‚
        â”‚  â”‚           â”‚ http://backend:8000             â”‚  â”‚
        â”‚  â”‚           â–¼                                 â”‚  â”‚
        â”‚  â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚  â”‚
        â”‚  â”‚  â•‘   Backend (FastAPI)      :8000     â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘                                    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ REST APIs                       â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ JWT Authentication              â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ File Uploads (40GB max)         â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Rate Limiting                   â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Container: hypersend_backend    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Image: hypersend-backend        â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Status: âœ… Healthy             â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘                                    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  Endpoints:                        â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ /api/v1/auth (login, register)  â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ /api/v1/chats (messaging)       â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ /api/v1/files (upload/download) â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ /api/v1/users (profiles)        â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ /health (status check)          â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ /docs (API documentation)       â•‘   â”‚  â”‚
        â”‚  â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚  â”‚
        â”‚  â”‚           â”‚                                 â”‚  â”‚
        â”‚  â”‚           â”‚ Authenticated Connection        â”‚  â”‚
        â”‚  â”‚           â”‚ mongodb://hypersend:pass@       â”‚  â”‚
        â”‚  â”‚           â”‚ mongodb:27017/hypersend         â”‚  â”‚
        â”‚  â”‚           â–¼                                 â”‚  â”‚
        â”‚  â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚  â”‚
        â”‚  â”‚  â•‘   MongoDB 7.0           :27017     â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘                                    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Authenticated Connection        â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Replica Set: rs0                â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Database: hypersend             â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Container: hypersend_mongodb    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Image: mongo:7.0                â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Status: âœ… Healthy             â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ Volumes: mongodb_data,          â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘            mongodb_config          â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘                                    â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  Collections:                      â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ users                           â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ chats                           â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ messages                        â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ files                           â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ uploads                         â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ refresh_tokens                  â•‘   â”‚  â”‚
        â”‚  â”‚  â•‘  â€¢ reset_tokens                    â•‘   â”‚  â”‚
        â”‚  â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚  â”‚
        â”‚  â”‚                                             â”‚  â”‚
        â”‚  â”‚  Volumes:                                  â”‚  â”‚
        â”‚  â”‚  â€¢ mongodb_data (database)                 â”‚  â”‚
        â”‚  â”‚  â€¢ mongodb_config (config)                 â”‚  â”‚
        â”‚  â”‚  â€¢ ./data (file uploads)                   â”‚  â”‚
        â”‚  â”‚  â€¢ ./backend/uploads (processing)          â”‚  â”‚
        â”‚  â”‚                                             â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â”‚                                                   â”‚
        â”‚  Health Checks:                                  â”‚
        â”‚  âœ… MongoDB      - Active & Responding           â”‚
        â”‚  âœ… Backend      - API Active & Connected        â”‚
        â”‚  âœ… Frontend     - Web Server Active             â”‚
        â”‚                                                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ DATA FLOW DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Browser â”‚ http://139.59.82.105:8550
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ HTTP/2
       â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Flet Frontend    â”‚
   â”‚ Port :8550       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ JSON over HTTP/2
            â”‚ (Authorization header)
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ FastAPI Backend          â”‚
   â”‚ Port :8000               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Routes:                  â”‚
   â”‚ â€¢ /auth/login            â”‚â”€â”
   â”‚ â€¢ /auth/register         â”‚ â”‚
   â”‚ â€¢ /chats                 â”‚ â”‚
   â”‚ â€¢ /messages              â”‚ â”‚
   â”‚ â€¢ /files/upload          â”‚ â”‚
   â”‚ â€¢ /files/download        â”‚ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
            â”‚                   â”‚
            â”‚ Database Queries  â”‚
            â”‚ (Authenticated)   â”‚
            â–¼                   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚ MongoDB                  â”‚ â”‚
   â”‚ Port :27017              â”‚ â”‚
   â”‚ Auth: hypersend/password â”‚â—„â”€â”˜
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Collections:             â”‚
   â”‚ â€¢ users                  â”‚
   â”‚ â€¢ chats                  â”‚
   â”‚ â€¢ messages               â”‚
   â”‚ â€¢ files                  â”‚
   â”‚ â€¢ uploads                â”‚
   â”‚ â€¢ refresh_tokens         â”‚
   â”‚ â€¢ reset_tokens           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Database Volume Persistence:
â€¢ mongodb_data  â† Stores all documents
â€¢ mongodb_config â† Stores configuration
```

---

## ğŸ” AUTHENTICATION FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               AUTHENTICATION & SESSION FLOW                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. LOGIN
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ User enters     â”‚
   â”‚ email/password  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ POST /api/v1/auth/login              â”‚
   â”‚ {                                    â”‚
   â”‚   "email": "user@example.com",       â”‚
   â”‚   "password": "secure123"            â”‚
   â”‚ }                                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Backend validates credentials        â”‚
   â”‚ Checks MongoDB users collection      â”‚
   â”‚ Verifies bcrypt password hash        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€ Invalid? â”€â”€â–º Return 401 Error
             â”‚
             â–¼ Valid
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Generate JWT tokens:                 â”‚
   â”‚ â€¢ access_token (15 min TTL)         â”‚
   â”‚ â€¢ refresh_token (30 day TTL)        â”‚
   â”‚                                      â”‚
   â”‚ Return to frontend:                  â”‚
   â”‚ {                                    â”‚
   â”‚   "access_token": "jwt...",         â”‚
   â”‚   "refresh_token": "jwt...",        â”‚
   â”‚   "token_type": "bearer"            â”‚
   â”‚ }                                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Frontend stores tokens locally       â”‚
   â”‚ â€¢ access_token â†’ localStorage        â”‚
   â”‚ â€¢ refresh_token â†’ httpOnly cookie    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. AUTHENTICATED REQUEST (while access_token valid)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ GET /api/v1/chats/                        â”‚
   â”‚ Header: Authorization: Bearer <token>    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Backend validates JWT signature           â”‚
   â”‚ Extracts user_id from payload             â”‚
   â”‚ Processes request                         â”‚
   â”‚ Returns: List of chats                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. TOKEN REFRESH (after access_token expires)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Frontend detects 401 Unauthorized         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ POST /api/v1/auth/refresh                 â”‚
   â”‚ {                                         â”‚
   â”‚   "refresh_token": "<long-lived-token>"  â”‚
   â”‚ }                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Backend validates refresh_token           â”‚
   â”‚ Checks MongoDB refresh_tokens collection  â”‚
   â”‚ If valid: Generate new access_token       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Return new access_token                   â”‚
   â”‚ Frontend updates token and retries        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¤ FILE UPLOAD FLOW

```
File Upload Process (up to 40GB):

1. Initialize
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ User selects â”‚
   â”‚ file (40GB)  â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ POST /api/v1/files/init                â”‚
   â”‚ {                                      â”‚
   â”‚   "filename": "video.mp4",             â”‚
   â”‚   "size": 42949672960,  (40GB)        â”‚
   â”‚   "mime": "video/mp4",                 â”‚
   â”‚   "chat_id": "123..."                  â”‚
   â”‚ }                                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Backend:                               â”‚
   â”‚ â€¢ Creates upload record                â”‚
   â”‚ â€¢ Calculates chunks (4MB each)         â”‚
   â”‚ â€¢ Returns upload_id, chunk_size, etc.  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼ Returns:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ {                                      â”‚
   â”‚   "upload_id": "upload_abc123",       â”‚
   â”‚   "chunk_size": 4194304,  (4MB)       â”‚
   â”‚   "total_chunks": 10240,  (10k)       â”‚
   â”‚   "max_parallel": 4                    â”‚
   â”‚   "expires_at": "2025-12-02T..."      â”‚
   â”‚ }                                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. Upload Chunks
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ For each chunk (max 4 parallel):          â”‚
   â”‚                                          â”‚
   â”‚ PUT /api/v1/files/{upload_id}/chunk      â”‚
   â”‚ Query: chunk_index=0                    â”‚
   â”‚ Body: [binary chunk data 4MB]           â”‚
   â”‚                                          â”‚
   â”‚ âœ… Chunk 0  (4MB)      â”€â”€â”€â”€â”€â”            â”‚
   â”‚ âœ… Chunk 1  (4MB)      â”€â”€â”€â”€â”€â”¼â”€â†’ Backend â”‚
   â”‚ âœ… Chunk 2  (4MB)      â”€â”€â”€â”€â”€â”¤   Stores â”‚
   â”‚ âœ… Chunk 3  (4MB)      â”€â”€â”€â”€â”€â”˜   to Disk â”‚
   â”‚                                          â”‚
   â”‚ (Then next 4 chunks...)                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Complete Upload
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ POST /api/v1/files/{upload_id}/complete  â”‚
   â”‚                                          â”‚
   â”‚ Backend:                                 â”‚
   â”‚ â€¢ Verifies all chunks received           â”‚
   â”‚ â€¢ Calculates checksum                    â”‚
   â”‚ â€¢ Creates file record in MongoDB         â”‚
   â”‚ â€¢ Sends success notification             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ {                                        â”‚
   â”‚   "file_id": "file_xyz789",            â”‚
   â”‚   "filename": "video.mp4",              â”‚
   â”‚   "size": 42949672960,                  â”‚
   â”‚   "status": "completed"                 â”‚
   â”‚ }                                        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

File Storage:
â€¢ Location: ./data (40GB mount)
â€¢ Structure: ./data/uploads/[file_id]/
â€¢ Retention: 0 hours (no server storage)
â€¢ Auto-cleanup: Expired uploads deleted
```

---

## ğŸ¯ DEPLOYMENT CHECKLIST

```
âœ… BACKEND READY
   â”œâ”€ FastAPI running on :8000
   â”œâ”€ Motor async driver connected
   â”œâ”€ MongoDB authenticated
   â”œâ”€ Health check active
   â””â”€ Production validation passing

âœ… FRONTEND READY
   â”œâ”€ Flet web app running on :8550
   â”œâ”€ HTTPx client configured
   â”œâ”€ VPS IP set (139.59.82.105)
   â”œâ”€ HTTP/2 enabled
   â””â”€ Health check active

âœ… DATABASE READY
   â”œâ”€ MongoDB 7.0 running on :27017
   â”œâ”€ Authentication enabled
   â”œâ”€ Replica set (rs0) active
   â”œâ”€ 7 collections created
   â””â”€ Volumes persisted

âœ… DOCKER COMPOSE READY
   â”œâ”€ Unified file (1 file)
   â”œâ”€ All services defined
   â”œâ”€ Bridge network configured
   â”œâ”€ Health checks configured
   â””â”€ Dependencies declared

âœ… VPS CONFIGURATION READY
   â”œâ”€ VPS_IP = 139.59.82.105
   â”œâ”€ DEBUG = False
   â”œâ”€ MONGO credentials set
   â”œâ”€ SECRET_KEY configured
   â””â”€ All ports open

âœ… DOCUMENTATION READY
   â”œâ”€ Deployment guide
   â”œâ”€ API documentation
   â”œâ”€ Troubleshooting guide
   â””â”€ Upload instructions

âœ… GITHUB READY
   â”œâ”€ All files staged
   â”œâ”€ Commit message prepared
   â””â”€ Ready to push
```

---

## ğŸš€ DEPLOYMENT STEPS

```
1. GitHub Upload (now)
   git push origin main
   â†“
2. VPS SSH Connection
   ssh root@139.59.82.105
   â†“
3. Clone Repository
   git clone https://github.com/Mayankvlog/Hypersend.git
   â†“
4. Start Services
   docker-compose up -d
   â†“
5. Verify Status
   docker-compose ps
   âœ… All services: Healthy
   â†“
6. Access Application
   Frontend: http://139.59.82.105:8550
   Backend:  http://139.59.82.105:8000
   Docs:     http://139.59.82.105:8000/docs
   â†“
7. Ready for Users
   âœ… Production Running
```

---

**Status**: âœ… ARCHITECTURE COMPLETE & READY FOR DEPLOYMENT

